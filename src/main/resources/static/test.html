<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>íšŒì›ê°€ì… API í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
        section { border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; border-radius: 8px; }
        input { margin: 5px 0; padding: 8px; width: 250px; display: block; }
        button { padding: 10px 20px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; }
        .result { margin-top: 10px; color: blue; font-weight: bold; }
    </style>
</head>
<body>
<h2>ğŸš€ Imprint íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸ í˜ì´ì§€</h2>

<section>
    <h3>1. ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ ë°œì†¡</h3>
    <input type="email" id="email" placeholder="ì´ë©”ì¼ ì…ë ¥ (ì˜ˆ: test@gmail.com)">
    <button onclick="sendMail()">ì¸ì¦ë²ˆí˜¸ ë°›ê¸°</button>
    <div id="mailResult" class="result"></div>
</section>

<section>
    <h3>2. ì¸ì¦ë²ˆí˜¸ í™•ì¸</h3>
    <input type="text" id="code" placeholder="ì¸ì¦ë²ˆí˜¸ 6ìë¦¬ ì…ë ¥">
    <button onclick="verifyCode()">ë²ˆí˜¸ í™•ì¸</button>
    <div id="verifyResult" class="result"></div>
</section>

<section>
    <h3>3. ìµœì¢… íšŒì›ê°€ì…</h3>
    <input type="text" id="nickname" placeholder="ë‹‰ë„¤ì„">
    <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
    <input type="text" id="name" placeholder="ì´ë¦„">
    <button onclick="joinUser()">ê°€ì…í•˜ê¸°</button>
    <div id="joinResult" class="result"></div>
</section>

<script>
    // ë©”ì¼ ë°œì†¡
    async function sendMail() {
        const email = document.getElementById('email').value.trim();
        try {
            const res = await axios.post(`/api/mail/send?email=${email}`);
            document.getElementById('mailResult').innerText = res.data;
        } catch (err) {
            document.getElementById('mailResult').innerText = "ì—ëŸ¬: " + err.response.data;
        }
    }

    // ì¸ì¦ë²ˆí˜¸ í™•ì¸
    async function verifyCode() {
        const email = document.getElementById('email').value;
        const code = document.getElementById('code').value;
        try {
            const res = await axios.post(`/api/mail/verify?email=${email}&code=${code}`);
            document.getElementById('verifyResult').innerText = res.data;
        } catch (err) {
            document.getElementById('verifyResult').innerText = "ì—ëŸ¬: " + err.response.data;
        }
    }

    // íšŒì›ê°€ì…
    async function joinUser() {
        const data = {
            email: document.getElementById('email').value,
            password: document.getElementById('password').value,
            nickname: document.getElementById('nickname').value,
            name: document.getElementById('name').value
        };

        console.log("ì „ì†¡ ë°ì´í„°:", data);

        try {
            const res = await axios.post('/account/signup', data);
            alert(res.data);
            document.getElementById('joinResult').innerText = res.data;
        } catch (err) {
            console.error("ì—ëŸ¬ ë°œìƒ:", err.response);
            const errorMsg = err.response && err.response.data ? err.response.data : "ì•Œ ìˆ˜ ì—†ëŠ” ì—ëŸ¬";
            document.getElementById('joinResult').innerText = "ì—ëŸ¬: " + errorMsg;
        }
    }

</script>
</body>
</html>